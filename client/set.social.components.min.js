(function(){

  'use strict';
  
  angular
    .module('set.social.components', []);

})();

(function() {

  'use strict';

  angular.module('set.social.components')
    .controller('containerController', ContainerController);

  ContainerController.$inject = ['$rootScope'];

  function ContainerController($rootScope) {

    var vm = this;
    vm.$onInit = onInit;
    vm.isOpenModal = false;
    vm.changeIsOpenModal =  changeIsOpenModal;

    function changeIsOpenModal() {
      vm.isOpenModal = !vm.isOpenModal;
    }

    function onInit() {
      vm.configChat = {
        "name"  : "Social Chat",
        "class" : "chat-icon",
        "counter": 0
      };
    };
  }
})();

(function() {
  'use strict';

  angular.module('set.social.components')
    .controller('indicatorController', IndicatorController);

  IndicatorController.inject = ['$rootScope', '$timeout'];

  function IndicatorController($rootScope, $timeout) {

    var vm = this;
    vm.$onInit = onInit;
    vm.click = click;

    function onInit() {
      if (vm.config) {
        vm.class    = vm.config.class;
        vm.name     = vm.config.name;
        vm.counter  = vm.config.counter;
       }
      // vm.notificationCounter();
    };

    function click() {
      // $rootScope.$emit('event-' + vm.source, vm.config);
      vm.open()
      console.log('click...Indicator')
    };

    vm.notificationCounter = function () {
      $rootScope.$on('notification-counter', function (event, data) {
        /*$timeout(function () {
          angular.element(document.querySelector('#indicator')).triggerHandler('click');
          // angular.element('#indicator').triggerHandler('click');
        }, 0);*/
        vm.counter = data;
      });
    };
  }
})();

(function(){
  'use strict';

  var component = {
    template:'<div ng-animate="\'animate\'" ng-if="$ctrl.isOpenModal" class="row margin-child set-container-box"><set-lucy class="col-md-2"></set-lucy><div class="col-md-10 set-container-box__services"><div class="row margin-child"><set-navigator resource="$ctrl.resource"></set-navigator></div><div class="row margin-child"><set-chat resource="$ctrl.resource" resource-name="$ctrl.resourceName"></set-chat></div></div></div><div ng-animate="\'animate\'" ng-if="!$ctrl.isOpenModal"><set-indicator config="$ctrl.configChat" resource="$ctrl.resource" open="$ctrl.changeIsOpenModal()"></set-indicator></div>',
    controller: 'containerController',
    bindings: {
      resource      : '<'
    }
  }

  angular.module('set.social.components')
    .component('setContainer', component);

})();


(function(){
  'use strict';
  var app = angular.module('set.social.components');
  app.component('setNavigator', {
    bindings: {
      resource : '<'
    },
    template:'<div class="nav-content"><div class="col-md-10 corner-left"><a ui-sref="set-chat-lucy" class="color-icon"><i class="fa fa-question-circle fa-lg" aria-hidden="true"></i></a> <a ui-sref="set-share" class="color-icon"><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i></a> <a ui-sref="set-attachment" class="color-icon"><i class="fa fa-paperclip fa-lg" aria-hidden="true"></i></a> <a ui-sref="set-document" class="color-icon"><i class="fa fa-sticky-note fa-lg" aria-hidden="true"></i></a> <a ui-sref="set-chat" class="color-icon"><i class="fa fa-comment fa-lg" aria-hidden="true"></i> <span ng-if="$ctrl.counter > 0" class="badge set-badge__counter" ng-click="$ctrl.click()">{{$ctrl.counter}}</span></a> <a ui-sref="set-info" class="color-icon"><i class="fa fa-info-circle fa-lg" aria-hidden="true"></i></a></div><div class="col-md-2 corner-right"><a href="javascript:void(0);" ng-click="$ctrl.close()" class="color-icon color-icon-remove"><i class="fa fa-times fa-lg" aria-hidden="true"></i></a></div></div>',
    controller: 'navigatorController'
  });
})();

(function() {

  'use strict';
  /**
   * @ngdoc function
   * @name modal.component
   * @description
   * Component Indicator
   */

  angular.module('set.social.components')
    .component('setIndicator', {
    template:'<div class="indicator"><a ng-click="$ctrl.click()" id="indicator"><div class="{{$ctrl.class}}"></div><span class="indicator-counter">{{$ctrl.counter}}</span></a></div>',
    controller: 'indicatorController',
    bindings: {
      config: "<",
      resource: "<",
      open: '&'
    }
  });
})();